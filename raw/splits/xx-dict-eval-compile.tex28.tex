====== Special Operator LOCALLY ======

====Syntax====

\DefspecWithValues locally {\starparam{declaration} \starparam{form}} {\starparam{result}}

====Arguments and Values====

//Declaration// - a \misc{declare} //[[CL:Glossary:expression]]//; \noeval.

//forms// - an //[[CL:Glossary:implicit progn]]//.

//results// - the //[[CL:Glossary:values]]// of the //forms//.

====Description====

Sequentially evaluates a body of //forms// in a //[[CL:Glossary:lexical environment]]// where the given //declarations// have effect.

====Examples====

<blockquote> (defun sample-function (y) ;this y is regarded as special (declare (special y)) (let ((y t)) ;this y is regarded as lexical (list y (locally (declare (special y)) ;; this next y is regarded as special y)))) → SAMPLE-FUNCTION (sample-function nil) → (T NIL) ([[CL:Macros:defparameter]] x '(1 2 3) y '(4 . 5)) → (4 . 5)

;;; The following declarations are not notably useful in specific. ;;; They just offer a sample of valid declaration syntax using LOCALLY. (locally (declare (inline floor) (notinline car cdr)) (declare (optimize space)) (floor (car x) (cdr y))) → 0, 1 </blockquote>

<blockquote> ;;; This example shows a definition of a function that has a particular set ;;; of OPTIMIZE settings made locally to that definition. (locally (declare (optimize (safety 3) (space 3) (speed 0))) (defun frob (w x y &optional (z (foo x y))) (mumble x y z w))) → FROB

;;; This is like the previous example, except that the optimize settings ;;; remain in effect for subsequent definitions in the same compilation unit. (declaim (optimize (safety 3) (space 3) (speed 0))) (defun frob (w x y &optional (z (foo x y))) (mumble x y z w)) → FROB </blockquote>

====Side Effects====

None.

====Affected By====

None.

====Exceptional Situations====

None.

====See Also====

\misc{declare}

====Notes====

The \declref{special} declaration may be used with \specref{locally} to affect references to, rather than //[[CL:Glossary:bindings]]// of, //[[CL:Glossary:variables]]//.

If a \specref{locally} //[[CL:Glossary:form]]// is a //[[CL:Glossary:top level form]]//, the body //forms// are also processed as //[[CL:Glossary:top level forms]]//. see section {\secref\FileCompilation}.

\issue{LOCALLY-TOP-LEVEL:SPECIAL-FORM} \issue{DECLS-AND-DOC} \issue{LOCALLY-TOP-LEVEL:SPECIAL-FORM} \issue{RETURN-VALUES-UNSPECIFIED:SPECIFY} \issue{LOCALLY-TOP-LEVEL:SPECIAL-FORM}
