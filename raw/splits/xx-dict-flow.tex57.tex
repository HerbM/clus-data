====== Macro PROG, PROG* ======

====Syntax====

\DefmacWithValuesNewline prog {\paren{\star{\curly{//var// ''\vert'' \paren{//var// [//init-form//]}}}} \starparam{declaration} \star{{//tag// ''\vert'' //statement//}}} {\starparam{result}}

\DefmacWithValuesNewline {prog*} {\paren{\star{\curly{//var// ''\vert'' \paren{//var// [//init-form//]}}}} \starparam{declaration} \star{{//tag// ''\vert'' //statement//}}} {\starparam{result}}

====Arguments and Values====

//var// - variable name.

//init-form// - a //[[CL:Glossary:form]]//.

//declaration// - a \misc{declare} //[[CL:Glossary:expression]]//; \noeval.

//tag// - a //[[CL:Glossary:go tag]]//; \noeval.

//statement// - a //[[CL:Glossary:compound form]]//; \evalspecial.

//results// - **[[CL:Constant Variables:nil]]** if a //[[CL:Glossary:normal return]]// occurs, or else, if an //[[CL:Glossary:explicit return]]// occurs, the //[[CL:Glossary:values]]// that were transferred.

====Description====

Three distinct operations are performed by **[[CL:Macros:prog]]** and **[[CL:Macros:prog*]]**: they bind local variables, they permit use of the **[[CL:Macros:return]]** statement, and they permit use of the \specref{go} statement. A typical **[[CL:Macros:prog]]** looks like this:

<blockquote> (prog (var1 var2 (var3 init-form-3) var4 (var5 init-form-5)) \starparam{declaration} statement1 tag1 statement2 statement3 statement4 tag2 statement5 ... ) </blockquote>

For **[[CL:Macros:prog]]**, //init-forms// are evaluated first, in the order in which they are supplied. The //vars// are then bound to the corresponding values in parallel. If no //init-form// is supplied for a given //var//, that //var// is bound to **[[CL:Constant Variables:nil]]**.

The body of **[[CL:Macros:prog]]** is executed as if it were a \specref{tagbody} //[[CL:Glossary:form]]//; the \specref{go} statement can be used to transfer control to a //tag//. //Tags// label //statements//.

**[[CL:Macros:prog]]** implicitly establishes a \specref{block} named **[[CL:Constant Variables:nil]]** around the entire **[[CL:Macros:prog]]** //[[CL:Glossary:form]]//, so that **[[CL:Macros:return]]** can be used at any time to exit from the **[[CL:Macros:prog]]** //[[CL:Glossary:form]]//.

The difference between **[[CL:Macros:prog*]]** and **[[CL:Macros:prog]]** is that in **[[CL:Macros:prog*]]** the //[[CL:Glossary:binding]]// and initialization of the //vars// is done //[[CL:Glossary:sequentially]]//, so that the //init-form// for each one can use the values of previous ones.

====Examples==== <blockquote> (prog* ((y z) (x (car y))) (return x)) </blockquote> returns the //[[CL:Glossary:car]]// of the value of ''z''.

<blockquote> ([[CL:Macros:defparameter]] a 1) → 1 (prog ((a 2) (b a)) (return (if (= a b) '= '/=))) → /= (prog* ((a 2) (b a)) (return (if (= a b) '= '/=))) → = (prog () 'no-return-value) → NIL </blockquote>

<blockquote> (defun king-of-confusion (w) "Take a cons of two lists and make a list of conses. Think of this function as being like a zipper." (prog (x y z) ;Initialize x, y, z to NIL ([[CL:Macros:defparameter]] y (car w) z (cdr w)) loop (cond ((null y) (return x)) ((null z) (go err))) rejoin ([[CL:Macros:defparameter]] x (cons (cons (car y) (car z)) x)) ([[CL:Macros:defparameter]] y (cdr y) z (cdr z)) (go loop) err (cerror "Will self-pair extraneous items" "Mismatch - gleep! ~S" y) ([[CL:Macros:defparameter]] z y) (go rejoin))) → KING-OF-CONFUSION </blockquote> This can be accomplished more perspicuously as follows:

<blockquote> (defun prince-of-clarity (w) "Take a cons of two lists and make a list of conses. Think of this function as being like a zipper." (do ((y (car w) (cdr y)) (z (cdr w) (cdr z)) (x '() (cons (cons (car y) (car z)) x))) ((null y) x) (when (null z) (cerror "Will self-pair extraneous items" "Mismatch - gleep! ~S" y) ([[CL:Macros:defparameter]] z y)))) → PRINCE-OF-CLARITY </blockquote>

====Affected By====

None.

====Exceptional Situations====

None.

====See Also====

\specref{block}, \specref{let}, \specref{tagbody}, \specref{go}, **[[CL:Macros:return]]**, {\secref\Evaluation}

====Notes====

**[[CL:Macros:prog]]** can be explained in terms of \specref{block}, \specref{let}, and \specref{tagbody} as follows:

<blockquote> (prog //variable-list// //declaration// . //body//) ≡ (block nil (let //variable-list// //declaration// (tagbody . //body//))) </blockquote>

\issue{DECLS-AND-DOC}
